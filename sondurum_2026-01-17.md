## sondurum_2026-01-17

Bu dosya, projede şu ana kadar yapılan işleri özetler.

### Genel

- Proje **Vite + React (TS) + Tailwind** olarak çalışır hale getirildi.
- Routing eklendi (**SPA**):
  - `/` anasayfa
  - `/ruya/:slug` detay
  - `/admin` salt-okunur admin panel

### SEO / Analytics / Static dosyalar

- GoatCounter eklendi: `index.html`
- SEO meta’ları eklendi: `index.html` (title/description/canonical/OG/Twitter + geo hints)
- Favicon + paylaşım görseli:
  - favicon: `/img/favicon.png`
  - OG/Twitter image: `/img/favicon.png`
  - Dosya yolu: `public/img/favicon.png`
- Robots + sitemap:
  - `public/robots.txt`
  - `public/sitemap.xml`
  - `public/sitemap.html`

### Dil / Üslup

- Site metinleri **İslami üsluba** çekildi (disclaimer: “Allah Teâlâ en doğrusunu bilir.”).
- Marka yazımı: **`hayrolsun.site`** / **`hayrolsun`** her yerde küçük harf.
- Başlık formatı: “**Rüyada X Görmek**” standardı (demo/seed + doküman).

### Turso (Database)

- Schema: `db/schema.sql`
  - `dreams`, `categories`, `tags`, `dream_tags`
  - FTS: `dreams_fts` + trigger’lar
  - Sayaç kolonları: `views`, `likes`, `dislikes`
- Seed: `db/seed.sql` (demo kayıtlar; sayaçlar 0)
- Migration/Seed scriptleri:
  - `npm run db:migrate` → `scripts/db-migrate.mjs` (idempotent; duplicate column hatasını yoksayar)
  - `npm run db:seed` → `scripts/db-seed.mjs`
- SQL dosyası çalıştırma:
  - `npm run db:sql -- <file.sql>` → `scripts/db-run-sql.mjs`

### API (Vercel serverless)

- Public:
  - `GET /api/dreams` → liste/arama/filtre
  - `GET /api/dreams/:slug` → detay (views/likes/dislikes + tags), `no-store`
  - `POST /api/dreams/:slug/view` → views artırır, `no-store`
  - `POST /api/dreams/:slug/vote` → like/dislike artırır, `no-store`
- Admin (token korumalı):
  - `GET /api/admin/summary`
  - `GET /api/admin/dreams`
  - `GET /api/admin/categories`
  - `POST /api/admin/sql` → sadece `INSERT` (ve kontrol amaçlı `SELECT`), whitelist tablolara

### Admin panel

- Sayfa: `/admin` (salt-okunur)
- Gösterdikleri:
  - rüya sayısı
  - toplam görüntülenme (tekil kişi değildir)
  - toplam like/dislike
  - kategori listesi + dreamCount
  - başlık listesi (slug, kategori, views, like/dislike)
- SQL import:
  - admin panelde “SQL Çalıştır (Import)” textarea’sı
  - header: `x-admin-token`

### İçerik importu

- Kullanıcının gönderdiği “islami” tabirler için import dosyası:
  - `db/import_islami.sql` (slug’a göre **UPSERT**; sayaçları sıfırlamaz)

### UI güncellemeleri

- Anasayfa demo modunda kategori filtresi düzeltildi (demo’da da sayım/filtre doğru).
- Detay sayfasında:
  - views + like/dislike sayaçları
  - WhatsApp paylaşım butonu

### Env değişkenleri

- Turso:
  - `TURSO_DATABASE_URL`
  - `TURSO_AUTH_TOKEN`
- Admin:
  - `ADMIN_TOKEN`

### Notlar / Kısıtlar

- “Siteye giren insan sayısı” (unique visitors) DB’den değil; GoatCounter gibi bir analytics kaynağından gelir.
- Like/dislike şu an kullanıcı hesabı olmadan; tekrar oy engeli tarayıcı bazlı `localStorage` ile.

